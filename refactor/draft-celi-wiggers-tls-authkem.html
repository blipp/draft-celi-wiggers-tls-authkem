<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>KEM-based Authentication for TLS 1.3</title>
<meta content="SofÃ­a Celi" name="author">
<meta content="Peter Schwabe" name="author">
<meta content="Douglas Stebila" name="author">
<meta content="Nick Sullivan" name="author">
<meta content="Thom Wiggers" name="author">
<meta content="
       This document gives a construction for KEM-based authentication in TLS
1.3. The overall design approach is a simple: usage of Key Encapsulation
Mechanisms (KEMs) to achieve certificate-based authentication. 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-celi-wiggers-tls-authkem-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.9.7
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.5
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 52.0.0
    six 1.16.0
-->
<link href="draft-celi-wiggers-tls-authkem.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow, svg + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
/* Trick: a prefix match works because only black and white are allowed */
svg [stroke="black"], svg [stroke^="#000"] {
  stroke: var(--text-color);
}
svg [stroke="white"], svg [stroke^="#fff"] {
  stroke: var(--background-color);
}
svg [fill="black"], svg [fill^="#000"], svg :not([fill]) {
  fill: var(--text-color);
}
svg [stroke="fill"], svg [fill^="#fff"] {
  fill: var(--background-color);
}
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">AuthKEM</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Celi, et al.</td>
<td class="center">Expires 29 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TLS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-celi-wiggers-tls-authkem-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-25" class="published">25 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-29">29 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Celi</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">P. Schwabe</div>
<div class="org">Radboud University &amp; MPI S&amp;P</div>
</div>
<div class="author">
      <div class="author-name">D. Stebila</div>
<div class="org">University of Waterloo</div>
</div>
<div class="author">
      <div class="author-name">N. Sullivan</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">T. Wiggers</div>
<div class="org">Radboud University</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">KEM-based Authentication for TLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document gives a construction for KEM-based authentication in TLS
1.3. The overall design approach is a simple: usage of Key Encapsulation
Mechanisms (KEMs) to achieve certificate-based authentication.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">Â¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    mailing list (),
  which is archived at <span><a href=""></a></span>.<a href="#section-note.1-2" class="pilcrow">Â¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/claucece/draft-celi-wiggers-tls-authkem">https://github.com/claucece/draft-celi-wiggers-tls-authkem</a></span>.<a href="#section-note.1-3" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.Â Â <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.Â Â <a href="#name-organization" class="xref">Organization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.Â Â <a href="#name-requirements-notation" class="xref">Requirements Notation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.Â Â <a href="#name-terminology" class="xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.Â Â <a href="#name-key-encapsulation-mechanism" class="xref">Key Encapsulation Mechanisms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.Â Â <a href="#name-full-15-rtt-authkem-handsha" class="xref">Full 1.5-RTT AuthKEM Handshake Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.Â Â <a href="#name-client-authentication" class="xref">Client authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.Â Â <a href="#name-relevant-handshake-messages" class="xref">Relevant handshake messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.Â Â <a href="#name-differences-with-rfc8446-tl" class="xref">Differences with RFC8446 TLS 1.3</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.Â Â <a href="#name-implicit-and-explicit-authe" class="xref">Implicit and explicit authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.Â Â <a href="#name-authenticating-certificater" class="xref">Authenticating CertificateRequest</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.Â Â <a href="#name-abbreviated-authkem-with-pr" class="xref">Abbreviated AuthKEM with pre-shared public KEM keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.Â Â <a href="#name-negotiation" class="xref">Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.Â Â <a href="#name-0-rtt-forward-secrecy-and-r" class="xref">0-RTT, forward secrecy and replay protection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.Â Â <a href="#name-implementation" class="xref">Implementation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.Â Â <a href="#name-negotiation-of-authkem" class="xref">Negotiation of AuthKEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.Â Â <a href="#name-clienthello-and-serverhello" class="xref">ClientHello and ServerHello extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.Â Â <a href="#name-stored-auth-key" class="xref">Stored Auth Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.Â Â <a href="#name-protocol-messages" class="xref">Protocol messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.Â Â <a href="#name-cryptographic-computations" class="xref">Cryptographic computations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.Â Â <a href="#name-key-schedule-for-full-authk" class="xref">Key schedule for full AuthKEM handshakes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.Â Â <a href="#name-abbreviated-authkem-key-sch" class="xref">Abbreviated AuthKEM key schedule</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.3">
                    <p id="section-toc.1-1.6.2.4.2.3.1"><a href="#section-6.4.3" class="xref">6.4.3</a>.Â Â <a href="#name-compuations-of-kem-shared-s" class="xref">Compuations of KEM shared secrets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.4">
                    <p id="section-toc.1-1.6.2.4.2.4.1"><a href="#section-6.4.4" class="xref">6.4.4</a>.Â Â <a href="#name-explicit-authentication-mes" class="xref">Explicit Authentication Messages</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.Â Â <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.Â Â <a href="#name-implicit-authentication" class="xref">Implicit authentication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.Â Â <a href="#name-old-text-below" class="xref">OLD TEXT BELOW</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.Â Â <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.Â Â <a href="#name-prior-knowledge-kem-auth" class="xref">Prior-knowledge KEM-Auth</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.Â Â <a href="#name-key-exchange-messages" class="xref">Key Exchange Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="xref">9.2.1</a>.Â Â <a href="#name-client-hello" class="xref">Client Hello</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="xref">9.2.2</a>.Â Â <a href="#name-server-hello" class="xref">Server Hello</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="xref">9.2.3</a>.Â Â <a href="#name-hello-retry-request" class="xref">Hello Retry Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#section-9.2.4" class="xref">9.2.4</a>.Â Â <a href="#name-extensions" class="xref">Extensions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.5">
                    <p id="section-toc.1-1.9.2.2.2.5.1"><a href="#section-9.2.5" class="xref">9.2.5</a>.Â Â <a href="#name-implicit-authentication-mes" class="xref">Implicit Authentication Messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.6">
                    <p id="section-toc.1-1.9.2.2.2.6.1"><a href="#section-9.2.6" class="xref">9.2.6</a>.Â Â <a href="#name-certificate" class="xref">Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.7">
                    <p id="section-toc.1-1.9.2.2.2.7.1"><a href="#section-9.2.7" class="xref">9.2.7</a>.Â Â <a href="#name-kem-encapsulation" class="xref">KEM Encapsulation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.8">
                    <p id="section-toc.1-1.9.2.2.2.8.1"><a href="#section-9.2.8" class="xref">9.2.8</a>.Â Â <a href="#name-explicit-authentication-mess" class="xref">Explicit Authentication Messages</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>.Â <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.Â Â <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.Â Â <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.Â Â <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: This is a work-in-progress draft.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">This document gives a construction for KEM-based authentication in TLS
1.3.  The overall design approach is a simple: usage of Key Encapsulation
Mechanisms (KEMs) for certificate-based authentication. Authentication happens via
asymmetric cryptography by the usage of KEMs advertised as the long-term KEM public
keys in the Certificate.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">TLS 1.3 is in essence a signed key exchange protocol (if using certificate-based
authentication). Authentication in TLS 1.3 is achieved by signing the handshake
transcript. KEM-based authentication provides authentication by deriving a
shared secret that is encapsulated against the public key contained in the
certificate. Only the holder of the private key corresponding to the certificate's
public key can derive the same shared secret and thus decrypt it's peers
messages.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">This approach is appropriate for endpoints that have KEM public keys. Though
this is currently rare, certificates could be issued with (EC)DH public keys as
specified for instance in <span>[<a href="#RFC8410" class="xref">RFC8410</a>]</span>, or using a delegation
mechanism, such as delegated credentials <span>[<a href="#I-D.ietf-tls-subcerts" class="xref">I-D.ietf-tls-subcerts</a>]</span>.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">In this proposal we use the DH-based KEMs from <span>[<a href="#I-D.irtf-cfrg-hpke" class="xref">I-D.irtf-cfrg-hpke</a>]</span>. We
believe KEMs are especially worth discussing in the context of the TLS protocol
because NIST is in the process of standardizing post-quantum KEM algorithms to
replace "classic" key exchange (based on elliptic curve or finite-field
Diffie-Hellman <span>[<a href="#NISTPQC" class="xref">NISTPQC</a>]</span>).<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<p id="section-1-6">This proposal draws inspiration from <span>[<a href="#I-D.ietf-tls-semistatic-dh" class="xref">I-D.ietf-tls-semistatic-dh</a>]</span>, which is in
turn based on the OPTLS proposal for TLS 1.3 <span>[<a href="#KW16" class="xref">KW16</a>]</span>. However, these proposals
require a non-interactive key exchange: they combine the client's public key with
the server's long-term key. This imposes a requirement that the ephemeral and
static keys use the same algorithm, which this proposal does not require.
Additionally, there are no post-quantum proposals for a non-interactive key
exchange currently considered for standardization, while several KEMs are on the
way.<a href="#section-1-6" class="pilcrow">Â¶</a></p>
<div id="organization">
<section id="section-1.1">
        <h3 id="name-organization">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-organization" class="section-name selfRef">Organization</a>
        </h3>
<p id="section-1.1-1">After a brief introduction to KEMs, we will introduce the AuthKEM authentication mechanism.
For clarity, we discuss unilateral and mutual authentication separately.
Next we will introduce the abbreviated AuthKEM handshake, and its opportunistic client authentication mechanism.
In the remainder of the draft we will discuss the necessary implementation mechanics, such as code points, extensions, new protocol messages and the new key schedule.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements-notation">
<section id="section-2">
      <h2 id="name-requirements-notation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCPÂ 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">The following terms are used as they are in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span><a href="#section-3-1" class="pilcrow">Â¶</a></p>
<p id="section-3-2">client:  The endpoint initiating the TLS connection.<a href="#section-3-2" class="pilcrow">Â¶</a></p>
<p id="section-3-3">connection:  A transport-layer connection between two endpoints.<a href="#section-3-3" class="pilcrow">Â¶</a></p>
<p id="section-3-4">endpoint:  Either the client or server of the connection.<a href="#section-3-4" class="pilcrow">Â¶</a></p>
<p id="section-3-5">handshake:  An initial negotiation between client and server that
  establishes the parameters of their subsequent interactions
  within TLS.<a href="#section-3-5" class="pilcrow">Â¶</a></p>
<p id="section-3-6">peer:  An endpoint.  When discussing a particular endpoint, "peer"
  refers to the endpoint that is not the primary subject of
  discussion.<a href="#section-3-6" class="pilcrow">Â¶</a></p>
<p id="section-3-7">receiver:  An endpoint that is receiving records.<a href="#section-3-7" class="pilcrow">Â¶</a></p>
<p id="section-3-8">sender:  An endpoint that is transmitting records.<a href="#section-3-8" class="pilcrow">Â¶</a></p>
<p id="section-3-9">server:  The endpoint that this did initiate the TLS connection.
  i.e. the peer of the client.<a href="#section-3-9" class="pilcrow">Â¶</a></p>
<div id="key-encapsulation-mechanisms">
<section id="section-3.1">
        <h3 id="name-key-encapsulation-mechanism">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-key-encapsulation-mechanism" class="section-name selfRef">Key Encapsulation Mechanisms</a>
        </h3>
<p id="section-3.1-1">As this proposal relies heavily on KEMs, which are not originally
used by TLS, we will provide a brief overview of this primitive.<a href="#section-3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-2">A Key Encapsulation Mechanism (KEM) is a cryptographic primitive that defines
the methods <code>Encapsulate</code> and <code>Decapapsulate</code>. In this draft, we extend these
operations with context separation strings:<a href="#section-3.1-2" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3"><code>Encapsulate(pkR, context_string)</code>:    Takes a public key, and produces a shared secret and encapsulation.<a href="#section-3.1-3" class="pilcrow">Â¶</a></p>
<p id="section-3.1-4"><code>Decapsulate(enc, skR, context_str)</code>:  Takes the encapsulation and the private key. Returns the shared secret.<a href="#section-3.1-4" class="pilcrow">Â¶</a></p>
<p id="section-3.1-5">We implement these methods through the KEMs defined in <span>[<a href="#I-D.irtf-cfrg-hpke" class="xref">I-D.irtf-cfrg-hpke</a>]</span>
as follows to export shared secrets appropriate for the use of HKDF in TLS 1.3:<a href="#section-3.1-5" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-6">
<pre>
def Encapsulate(pk, context_string):
  enc, ctx = HPKE.SetupBaseS(pk, "tls13 auth-kem " + context_string)
  ss = ctx.Export("", HKDF.Length)
  return (enc, ss)

Decapsulate(enc, sk, context_string) =
  HPKE.SetupBaseR(enc, sk, "tls13 auth-kem " + context_string)
      .Export("", HKDF.Length)
</pre><a href="#section-3.1-6" class="pilcrow">Â¶</a>
</div>
<p id="section-3.1-7">Keys are generated and encoded for transmission following the conventions in <span>[<a href="#I-D.irtf-cfrg-hpke" class="xref">I-D.irtf-cfrg-hpke</a>]</span>.<a href="#section-3.1-7" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="full-15-rtt-authkem-handshake-protocol">
<section id="section-4">
      <h2 id="name-full-15-rtt-authkem-handsha">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-full-15-rtt-authkem-handsha" class="section-name selfRef">Full 1.5-RTT AuthKEM Handshake Protocol</a>
      </h2>
<p id="section-4-1">Figure 1 below shows the basic KEM-authentication (KEM-Auth) handshake,
without client authentication:<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-2">
<pre>
       Client                                     Server

Key  ^ ClientHello
Exch | + key_share
     v + signature_algorithms
                          --------&gt;
                                             ServerHello  ^ Key
                                             + key_share  v Exch
                                   &lt;EncryptedExtensions&gt;
                                           &lt;Certificate&gt;  ^
       &lt;KEMEncapsulation&gt;  --------&gt;                      |
       {Finished}          --------&gt;                      | Auth
       [Application Data]  --------&gt;                      |
                           &lt;--------          {Finished}  v

       [Application Data]  &lt;-------&gt;  [Application Data]

        +  Indicates noteworthy extensions sent in the
           previously noted message.
        &lt;&gt; Indicates messages protected using keys
           derived from a [sender]_handshake_traffic_secret.
        {} Indicates messages protected using keys
           derived from a
           [sender]_authenticated_handshake_traffic_secret.
        [] Indicates messages protected using keys
           derived from [sender]_application_traffic_secret_N.

       Figure 1: Message Flow for KEM-Authentication (KEM-Auth)
                 Handshake without client authentication.
</pre><a href="#section-4-2" class="pilcrow">Â¶</a>
</div>
<p id="section-4-3">This basic handshake captures the core of AuthKEM.
Instead of using a signature to authenticate the handshake, the client encapsulates a shared secret to the server's certificate.
Only the server that holds the private key corresponding to the certificate can derive the same shared secret.
This shared secret is mixed into the handshake's key schedule.
The client does not have to wait for the server's <code>Finished</code> message before it can send data. 
It knows that its message can only be decrypted if the server was able to derive the authentication shared secret encapsulated in the <code>KEMEncapsulation</code> message.<a href="#section-4-3" class="pilcrow">Â¶</a></p>
<p id="section-4-4"><code>Finished</code> messages are sent as in TLS 1.3, and achieve full explicit authentication.<a href="#section-4-4" class="pilcrow">Â¶</a></p>
<div id="client-authentication">
<section id="section-4.1">
        <h3 id="name-client-authentication">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-client-authentication" class="section-name selfRef">Client authentication</a>
        </h3>
<p id="section-4.1-1">For client authentication, the server sends the <code>CertificateRequest</code> message as in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.
This message can not be authenticated in during the AuthKEM handshake: we will discuss the implications below.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.1-2">As in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, section 4.4.2, if and only if the client receives <code>CertificateRequest</code>, it MUST send a <code>Certificate</code> message.
If the client has no suitable certificate, it MUST send a <code>Certificate</code> message containing no certificates.
If the server is satisfied with the provided certificate, it MUST send back a <code>KEMEncapsulation</code> message, containing the encapsulation to the client's certificate.
The resulting shared secret is mixed into the key schedule.
This ensures any messages sent using keys derived from it are covered by the authentication.<a href="#section-4.1-2" class="pilcrow">Â¶</a></p>
<p id="section-4.1-3">The AuthKEM handshake with client authentication is given in Figure 2.<a href="#section-4.1-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>
       Client                                     Server

Key  ^ ClientHello
Exch | + key_share
     v + signature_algorithms
                          --------&gt;
                                             ServerHello  ^ Key
                                             + key_share  v Exch
                                   &lt;EncryptedExtensions&gt;  ^ Server
                                    &lt;CertificateRequest&gt;  v Params
                                           &lt;Certificate&gt;  ^
     ^ &lt;KEMEncapsulation&gt;                                 |
     | {Certificate}       --------&gt;                      |
Auth |                     &lt;--------  {KEMEncapsulation}  | Auth
     v {Finished}          --------&gt;                      |
       [Application Data]  --------&gt;                      |
                           &lt;-------           {Finished}  v

       [Application Data]  &lt;-------&gt;  [Application Data]

        +  Indicates noteworthy extensions sent in the
           previously noted message.
        &lt;&gt; Indicates messages protected using keys
           derived from a [sender]_handshake_traffic_secret.
        {} Indicates messages protected using keys
           derived from a
           [sender]_authenticated_handshake_traffic_secret.
        [] Indicates messages protected using keys
           derived from [sender]_application_traffic_secret_N.

       Figure 2: Message Flow for KEM-Authentication (KEM-Auth)
                 Handshake with client authentication.
</pre><a href="#section-4.1-4" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1-5">If the server is not satisfied with the client's certificates, it MAY, at its discretion, decide to continue or terminate the handshake.<a href="#section-4.1-5" class="pilcrow">Â¶</a></p>
<p id="section-4.1-6">Unfortunately, AuthKEM client authentication requires an extra round-trip.
Clients that know the server's long-term public KEM key might choose to use the abbreviated AuthKEM handshake and opportunistically send the client certificate as a 0-RTT-like message.
We will discuss this later.<a href="#section-4.1-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="relevant-handshake-messages">
<section id="section-4.2">
        <h3 id="name-relevant-handshake-messages">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-relevant-handshake-messages" class="section-name selfRef">Relevant handshake messages</a>
        </h3>
<p id="section-4.2-1">After the Key Exchange and Server Parameters phase of TLS 1.3 handshake, the
client and server exchange implicitly authenticated messages.
KEM-based authentication uses the same set of messages every time that
certificate-based authentication is needed.  Specifically:<a href="#section-4.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1"><code>Certificate</code>:  The certificate of the endpoint and any per-certificate   extensions.  This message is omitted by the client if the server did not send CertificateRequest (thus indicating that the client should not authenticate with a certificate). For AuthKEM, <code>Certificate</code> MUST include the long-term KEM public key.<a href="#section-4.2-2.1.1" class="pilcrow">Â¶</a></p>
<p id="section-4.2-2.1.2">
Certificates MUST be handled in accordance with <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, section 4.4.2.4.<a href="#section-4.2-2.1.2" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <code>KEMEncapsulation</code>: A key encapsulation against the certificate's long-term   public key, which yields an implicitly authenticated shared secret.<a href="#section-4.2-2.2" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="differences-with-rfc8446-tls-13">
<section id="section-4.3">
        <h3 id="name-differences-with-rfc8446-tl">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-differences-with-rfc8446-tl" class="section-name selfRef">Differences with RFC8446 TLS 1.3</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.3-1.1">New types of <code>signature_algorithms</code> for KEMs.<a href="#section-4.3-1.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.3-1.2">New handshake message <code>KEMEncapsulation</code><a href="#section-4.3-1.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.3-1.3">The client sends <code>Finished</code> before the server.<a href="#section-4.3-1.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.3-1.4">The clients sends data before the server has sent <code>Finished</code>.<a href="#section-4.3-1.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="implicit-and-explicit-authentication">
<section id="section-4.4">
        <h3 id="name-implicit-and-explicit-authe">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-implicit-and-explicit-authe" class="section-name selfRef">Implicit and explicit authentication</a>
        </h3>
<p id="section-4.4-1">The data that the client MAY transmit to the server before having received the server's <code>Finished</code> is encrypted
using ciphersuites chosen based on the client's and server's advertised preferences in the <code>ClientHello</code> and <code>ServerHello</code> messages.
The <code>ServerHello</code> message can however not be authenticated before the <code>Finished</code> message from the server is verified.
The full implications of this are discussed in the Security Considerations section.<a href="#section-4.4-1" class="pilcrow">Â¶</a></p>
<p id="section-4.4-2">Upon receiving the client's authentication messages, the server responds with its
Finished message, which achieves explicit authentication.
Upon receiving the server's <code>Finished</code> message, the client achieves explicit
authentication.
Receiving this message retroactively confirms the server's cryptographic parameter choices.<a href="#section-4.4-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="authenticating-certificaterequest">
<section id="section-4.5">
        <h3 id="name-authenticating-certificater">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-authenticating-certificater" class="section-name selfRef">Authenticating CertificateRequest</a>
        </h3>
<p id="section-4.5-1">The <code>CertificateRequest</code> message can not be authenticated during the AuthKEM handshake;
only after <code>Finished</code> from the server has been processed do we know it was authentic.
The security implications of this are discussed later.<a href="#section-4.5-1" class="pilcrow">Â¶</a></p>
<p id="section-4.5-2"><strong>This is dicussed in <a href="https://github.com/claucece/draft-celi-wiggers-tls-authkem/issues/16">Github issue #16</a>.
We would welcome feedback there.</strong><a href="#section-4.5-2" class="pilcrow">Â¶</a></p>
<p id="section-4.5-3">Clients MAY choose to only accept post-handshake authentication.
[Todo: Should they indicate this?]<a href="#section-4.5-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="abbreviated-authkem-with-pre-shared-public-kem-keys">
<section id="section-5">
      <h2 id="name-abbreviated-authkem-with-pr">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-abbreviated-authkem-with-pr" class="section-name selfRef">Abbreviated AuthKEM with pre-shared public KEM keys</a>
      </h2>
<p id="section-5-1">When the client already has the server's long-term public key, we can do a more efficient handshake.
The client will send the encapsulation to the server's long-term public key in a <code>ClientHello</code> extension.
An overview of the abbreviated AuthKEM handshake is given in Figure 3.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">A client that already knows the server, might also already know that it will be required to present a client certificate.
We expect this to be especially useful in server-to-server scenarios.
The abbreviated handshake allows to encrypt the certificate and send it like early data.<a href="#section-5-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-3">
<pre>
       Client                                        Server
Key  ^ ClientHello
Exch | + key_share
&amp;    | + stored_auth_key
Auth | + signature_algorithms
     | + early_auth*
     | + early_data*
     | (Certificate*)
     | (Application Data*)    --------&gt;        ServerHello  ^ Key
     |                                         + key_share  |
     |                                   + stored_auth_key  |
     |                                       + early_auth*  | Exch,
     |                                       + early_data*  | Auth &amp;
     |                               {EncryptedExtensions}  | Server
     |                                 {KEMEncapsulation*}  | Params
     |                       &lt;--------          {Finished}  v
     |                       &lt;-------- [Application Data*]
     | (EndOfEarlyData)
     v {Finished}            --------&gt;

       [Application Data]    &lt;-------&gt;  [Application Data]

        +  Indicates noteworthy extensions sent in the
           previously noted message.
        *  Indicates optional or situation-dependent
           messages/extensions that are not always sent.
        &lt;&gt; Indicates messages protected using keys
           derived from a
           client_early_handshake_traffic_secret.
        () Indicates messages protected using keys derived
           from a client_early_traffic_secret.
        {} Indicates messages protected using keys
           derived from a
           [sender]_handshake_traffic_secret.
        [] Indicates messages protected using keys
           derived from [sender]_application_traffic_secret_N.

      Figure 3: Abbreviated AuthKEM handshake, with optional
                opportunistic client authentication.
</pre><a href="#section-5-3" class="pilcrow">Â¶</a>
</div>
<div id="sec-authkem-pdk-negotiation">
<section id="section-5.1">
        <h3 id="name-negotiation">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-negotiation" class="section-name selfRef">Negotiation</a>
        </h3>
<p id="section-5.1-1">A client that knows a server's long-term KEM public key MAY choose to attempt the abbreviated AuthKEM handshake.
If it does so, it MUST include the <code>stored_auth_key</code> extension in the <code>ClientHello</code> message.
This message MUST contain the encapsulation against the long-term KEM public key.
Details of the extension are described below.
The shared secret resulting from the encapsulation is mixed in to the EarlySecret computation.<a href="#section-5.1-1" class="pilcrow">Â¶</a></p>
<p id="section-5.1-2">The client MAY additionally choose to send a certificate to the server.
It MUST know what ciphersuites the server accepts before it does so.
If it chooses to do so, it MUST send the <code>early_auth</code> extension to the server.
The <code>Certificate</code> is encrypted with the <code>client_early_handshake_traffic_secret</code>.<a href="#section-5.1-2" class="pilcrow">Â¶</a></p>
<p id="section-5.1-3">TODO: describe encaps/decaps parameters.<a href="#section-5.1-3" class="pilcrow">Â¶</a></p>
<p id="section-5.1-4">The server MAY accept the abbreviated AuthKEM handshake.
If it does, it MUST reply with a <code>stored_auth_key</code> extension.
If it does not accept the abbreviated AuthKEM handshake, for instance because it does not have access to the correct secret key anymore, it MUST NOT reply with a <code>stored_auth_key</code> extension.
The server, if it accepts the abbreviated AuthKEM handshake, MAY additionally accept the <code>Certificate</code> message.
If it does, it MUST reply with a <code>early_auth</code> extension.<a href="#section-5.1-4" class="pilcrow">Â¶</a></p>
<p id="section-5.1-5">If the client, who sent a <code>stored_auth_key</code> extension, receives a <code>ServerHello</code> without <code>stored_auth_key</code> extension,
it MUST recompute <code>EarlySecret</code> without the encapsulated shared secret. 
If the client sent a <code>Certificate</code> message, it MUST drop that message from its transcript.
The client MUST then continue with a full AuthKEM handshake.<a href="#section-5.1-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="rtt-forward-secrecy-and-replay-protection">
<section id="section-5.2">
        <h3 id="name-0-rtt-forward-secrecy-and-r">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-0-rtt-forward-secrecy-and-r" class="section-name selfRef">0-RTT, forward secrecy and replay protection</a>
        </h3>
<p id="section-5.2-1">The client MAY send 0-RTT data, as in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> 0-RTT mode.
The <code>Certificate</code> MUST be sent before the 0-RTT data.<a href="#section-5.2-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2-2">As the <code>EarlySecret</code> is derived only from a key encapsulated to a long-term secret, it does not have forward secrecy.
Clients MUST take this into consideration before transmitting 0-RTT data or opting in to early client auth.
Certificates and 0-RTT data may also be replayed.<a href="#section-5.2-2" class="pilcrow">Â¶</a></p>
<p id="section-5.2-3">This will be discussed in full under Security Considerations.<a href="#section-5.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation">
<section id="section-6">
      <h2 id="name-implementation">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation" class="section-name selfRef">Implementation</a>
      </h2>
<p id="section-6-1">In this section we will discuss the implementation details such as extensions and key schedule.<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<div id="negotiation-of-authkem">
<section id="section-6.1">
        <h3 id="name-negotiation-of-authkem">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-negotiation-of-authkem" class="section-name selfRef">Negotiation of AuthKEM</a>
        </h3>
<p id="section-6.1-1">Clients will indicate support for this mode by negotiating it as if
it were a signature scheme (part of the <code>signature_algorithms</code> extension). We thus
add these new signature scheme values (even though, they are not signature
schemes) for the KEMs defined in <span>[<a href="#I-D.irtf-cfrg-hpke" class="xref">I-D.irtf-cfrg-hpke</a>]</span> Section 7.1. Note that
we will be only using their internal KEM's API defined there.<a href="#section-6.1-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
  enum {
    dhkem_p256_sha256   =&gt; TBD,
    dhkem_p384_sha384   =&gt; TBD,
    dhkem_p521_sha512   =&gt; TBD,
    dhkem_x25519_sha256 =&gt; TBD,
    dhkem_x448_sha512   =&gt; TBD,
  }
</pre><a href="#section-6.1-2" class="pilcrow">Â¶</a>
</div>
<p id="section-6.1-3">When present in the <code>signature_algorithms</code> extension, these values indicate AuthKEM support with the specified key exchange mode. 
These values MUST NOT appear in <code>signature_algorithms_cert</code>, as this extension specifies the signing algorithms by which certificates are signed.<a href="#section-6.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="clienthello-and-serverhello-extensions">
<section id="section-6.2">
        <h3 id="name-clienthello-and-serverhello">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-clienthello-and-serverhello" class="section-name selfRef">ClientHello and ServerHello extensions</a>
        </h3>
<p id="section-6.2-1">A number of AuthKEM messages contain tag-length-value encoded extensions structures. 
We are adding those extensions to the <code>ExtensionType</code> list from TLS 1.3.<a href="#section-6.2-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
enum {
    ...
    stored_auth_key (TBD),                 /* RFC TBD */
    early_auth (TBD),                      /* RFC TBD */
    (65535)
} ExtensionType;
</pre><a href="#section-6.2-2" class="pilcrow">Â¶</a>
</div>
<p id="section-6.2-3">The table below indicates the messages where a given extension may
appear:<a href="#section-6.2-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-4">
<pre>
+---------------------------------------+-------------+
| Extension                             |    KEM-Auth |
+---------------------------------------+-------------+
| stored_auth_key [RFCTBD]              |      CH, SH |
|                                       |             |
| early_auth  [RFCTBD]                  |      CH, SH |
|                                       |             |
+---------------------------------------+-------------+
</pre><a href="#section-6.2-4" class="pilcrow">Â¶</a>
</div>
<div id="stored-auth-key">
<section id="section-6.2.1">
          <h4 id="name-stored-auth-key">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-stored-auth-key" class="section-name selfRef">Stored Auth Key</a>
          </h4>
<p id="section-6.2.1-1">To transmit the early authentication encapsulation in the abbreviated AuthKEM handshake, this document defines a new extension type (<code>stored_auth_key (TBD)</code>).
It is used in ClientHello and ServerHello messages.<a href="#section-6.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-6.2.1-2">The extension_data field of this extension, when included in the
ClientHello, MUST contain the <code>StoredInformation</code> structure.<a href="#section-6.2.1-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-3">
<pre>
  struct {
       select (type) {
         case client:
           opaque hash_value&lt;1..255&gt;;
           opaque ciphertext&lt;1..2^16-1&gt;
         case server:
           AcceptedAuthKey '1';
       } body;
  } StoredInformation
</pre><a href="#section-6.2.1-3" class="pilcrow">Â¶</a>
</div>
<p id="section-6.2.1-4">This document defines the following type:<a href="#section-6.2.1-4" class="pilcrow">Â¶</a></p>
<p id="section-6.2.1-5">TODO: SIMPLIFY<a href="#section-6.2.1-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-6.1">'pub_key' type for not sending the complete server certificate message:
 With the type field set to 'pub_key', the client MUST include the
 fingerprint of the Public Key of the end-entity certificate in
 the hash_value field. For this type, the fingerprint MUST be calculated
 using the procedure below, using the Public Key (represented
 using the Subject Public Key Info representation, as defined in <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>,
 Section 4.1.2.7) as the input data.<a href="#section-6.2.1-6.1" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-6.2.1-7">The fingerprint calculation proceeds this way:<a href="#section-6.2.1-7" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.1-8">
<li id="section-6.2.1-8.1">Compute the SHA-256 hash of the input data. Note that the computed
hash only covers the input data structure (and not any type and
length information of the record layer).<a href="#section-6.2.1-8.1" class="pilcrow">Â¶</a>
</li>
            <li id="section-6.2.1-8.2">Use the output of the SHA-256 hash.<a href="#section-6.2.1-8.2" class="pilcrow">Â¶</a>
</li>
          </ol>
<p id="section-6.2.1-9">The purpose of the fingerprint provided by the client is to help the
server select the correct information. The fingerprint identifies the server
public key (and the corresponding private key) for use with the rest
of the handshake.<a href="#section-6.2.1-9" class="pilcrow">Â¶</a></p>
<p id="section-6.2.1-10">If this extension is not present, the <code>kem_encapsulation</code> extension MUST
not be present as well. If present, it will be ignored.<a href="#section-6.2.1-10" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-messages">
<section id="section-6.3">
        <h3 id="name-protocol-messages">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-protocol-messages" class="section-name selfRef">Protocol messages</a>
        </h3>
<p id="section-6.3-1">The handshake protocol is used to negotiate the security parameters
of a connection, as in TLS 1.3. It uses the same messages, expect
for the addition of a <code>KEMEncapsulation</code> message and does not use
the <code>CertificateVerify</code> one.<a href="#section-6.3-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-2">
<pre>
  enum {
      ...
      kem_encapsulation(tbd),
      ...
      (255)
    } HandshakeType;

  struct {
      HandshakeType msg_type;    /* handshake type */
      uint24 length;             /* remaining bytes in message */
      select (Handshake.msg_type) {
          ...
          case kem_encapsulation:     KEMEncapsulation;
          ...
      };
  } Handshake;
</pre><a href="#section-6.3-2" class="pilcrow">Â¶</a>
</div>
<p id="section-6.3-3">Protocol messages MUST be sent in the order defined in Section 4.
A peer which receives a handshake message in an unexpected order MUST
abort the handshake with an "unexpected_message" alert.<a href="#section-6.3-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="cryptographic-computations">
<section id="section-6.4">
        <h3 id="name-cryptographic-computations">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-cryptographic-computations" class="section-name selfRef">Cryptographic computations</a>
        </h3>
<p id="section-6.4-1">The AuthKEM handshake establishes three input secrets which are
combined to create the actual working keying material, as detailed below. The
key derivation process incorporates both the input secrets and the handshake
transcript.  Note that because the handshake transcript includes the random
values from the Hello messages, any given handshake will have different traffic
secrets, even if the same input secrets are used.<a href="#section-6.4-1" class="pilcrow">Â¶</a></p>
<div id="key-schedule-for-full-authkem-handshakes">
<section id="section-6.4.1">
          <h4 id="name-key-schedule-for-full-authk">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-key-schedule-for-full-authk" class="section-name selfRef">Key schedule for full AuthKEM handshakes</a>
          </h4>
<p id="section-6.4.1-1">AuthKEM uses the same HKDF-Extract and HKDF-Expand functions as defined by
TLS 1.3, in turn defined by <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>.<a href="#section-6.4.1-1" class="pilcrow">Â¶</a></p>
<p id="section-6.4.1-2">Keys are derived from two input secrets using the HKDF-Extract and
Derive-Secret functions.  The general pattern for adding a new secret
is to use HKDF-Extract with the Salt being the current secret state
and the Input Keying Material (IKM) being the new secret to be added.<a href="#section-6.4.1-2" class="pilcrow">Â¶</a></p>
<p id="section-6.4.1-3">The key schedule proceeds as follows:<a href="#section-6.4.1-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.1-4">
<pre>
            0
            |
            v
    PSK -&gt; HKDF-Extract = Early Secret
            |
            +--&gt; Derive-Secret(., "ext binder" | "res binder", "")
            |                  = binder_key
            |
            +--&gt; Derive-Secret(., "c e traffic", ClientHello)
            |                  = client_early_traffic_secret
            |
            +--&gt; Derive-Secret(., "e exp master", ClientHello)
            |                  = early_exporter_master_secret
            v
            Derive-Secret(., "derived", "")
            |
            v
(EC)DHE -&gt; HKDF-Extract = Handshake Secret
            |
            +--&gt; Derive-Secret(., "c hs traffic",
            |                  ClientHello...ServerHello)
            |                  = client_handshake_traffic_secret
            |
            +--&gt; Derive-Secret(., "s hs traffic",
            |                  ClientHello...ServerHello)
            |                  = server_handshake_traffic_secret
            v
            Derive-Secret(., "derived", "") = dHS
            |
            v
    SSs -&gt; HKDF-Extract = Authenticated Handshake Secret
            |
            +--&gt; Derive-Secret(., "c ahs traffic",
            |                  ClientHello...KEMEncapsulation)
            |                  = client_handshake_authenticated_traffic_secret
            |
            +--&gt; Derive-Secret(., "s ahs traffic",
            |                  ClientHello...KEMEncapsulation)
            |                  = server_handshake_authenticated_traffic_secret
            v
            Derive-Secret(., "derived", "") = dAHS
            |
            v
SSc||0 * -&gt; HKDF-Extract = Main Secret
            |
            +--&gt; Derive-Secret(., "c ap traffic",
            |                  ClientHello...server Finished)
            |                  = client_application_traffic_secret_0
            |
            +--&gt; Derive-Secret(., "s ap traffic",
            |                  ClientHello...server Finished)
            |                  = server_application_traffic_secret_0
            |
            +--&gt; Derive-Secret(., "exp master",
            |                  ClientHello...server Finished)
            |                  = exporter_master_secret
            |
            +--&gt; Derive-Secret(., "res master",
                               ClientHello...client Finished)
                               = resumption_master_secret

The * means that if client authentication was requested the `SSc` value should
be used. Otherwise, the `0` value is used.
</pre><a href="#section-6.4.1-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="abbreviated-authkem-key-schedule">
<section id="section-6.4.2">
          <h4 id="name-abbreviated-authkem-key-sch">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-abbreviated-authkem-key-sch" class="section-name selfRef">Abbreviated AuthKEM key schedule</a>
          </h4>
<p id="section-6.4.2-1">The abbreviated AuthKEM handshake follows the <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> key schedule more closely.
We change the computation of the <code>EarlySecret</code> as follows:
~~~
            0
            |
            v
    SSs -&gt; HKDF-Extract = Early Secret
~~~<a href="#section-6.4.2-1" class="pilcrow">Â¶</a></p>
<p id="section-6.4.2-2">We change the computation of <code>Main Secret</code> as follows:
~~~
            Derive-Secret(., "derived", "") = dHS
            |
            v
SSc||0 * -&gt; HKDF-Extract = Main Secret
~~~<a href="#section-6.4.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="compuations-of-kem-shared-secrets">
<section id="section-6.4.3">
          <h4 id="name-compuations-of-kem-shared-s">
<a href="#section-6.4.3" class="section-number selfRef">6.4.3. </a><a href="#name-compuations-of-kem-shared-s" class="section-name selfRef">Compuations of KEM shared secrets</a>
          </h4>
<p id="section-6.4.3-1">The operations to compute <code>SSs</code> or <code>SSc</code> from the client are:<a href="#section-6.4.3-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.3-2">
<pre>
SSs, encapsulation &lt;- Encapsulate(public_key_server,
                                  "server authentication")
               SSc &lt;- Decapsulate(encapsulation, private_key_client,
                                  "client authentication")
</pre><a href="#section-6.4.3-2" class="pilcrow">Â¶</a>
</div>
<p id="section-6.4.3-3">The operations to compute <code>SSs</code> or <code>SSc</code> from the server are:<a href="#section-6.4.3-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.3-4">
<pre>
               SSs &lt;- Decapsulate(encapsulation, private_key_server
                                  "server authentication")
SSc, encapsulation &lt;- Encapsulate(public_key_client,
                                  "client authentication")
</pre><a href="#section-6.4.3-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="explicit-authentication-messages">
<section id="section-6.4.4">
          <h4 id="name-explicit-authentication-mes">
<a href="#section-6.4.4" class="section-number selfRef">6.4.4. </a><a href="#name-explicit-authentication-mes" class="section-name selfRef">Explicit Authentication Messages</a>
          </h4>
<p id="section-6.4.4-1">As discussed, AuthKEM generally uses a message for explicit
authentication: Finished message. Note that in the non pre-distributed mode,
AuthKEM achieves explicit authentication only when the server sends the final
<code>Finished</code> message (the client is only implicitly authenticated when they
send their <code>Finished</code> message). In a pre-distributed mode, the server achieves
explicit authentication when sending their <code>Finished</code> message (one round-trip
earlier) and the client, in turn, when they send their <code>Finished</code> message
(one round-trip earlier). Full downgrade resilience and forward secrecy
is achieved once the AuthKEM handshake completes.<a href="#section-6.4.4-1" class="pilcrow">Â¶</a></p>
<p id="section-6.4.4-2">The key used to compute the <code>Finished</code> message is computed from the
<code>MainSecret</code> using HKDF. Specifically:<a href="#section-6.4.4-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.4-3">
<pre>
server/client_finished_key =
  HKDF-Expand-Label(MainSecret,
                    server/client_label,
                    "", Hash.length)
server_label = "tls13 server finished"
client_label = "tls13 client finished"
</pre><a href="#section-6.4.4-3" class="pilcrow">Â¶</a>
</div>
<p id="section-6.4.4-4">Structure of this message:<a href="#section-6.4.4-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.4-5">
<pre>
  struct {
      opaque verify_data[Hash.length];
  } Finished;
</pre><a href="#section-6.4.4-5" class="pilcrow">Â¶</a>
</div>
<p id="section-6.4.4-6">The verify_data value is computed as follows:<a href="#section-6.4.4-6" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.4.4-7">
<pre>
server/client_verify_data =
      HMAC(server/client_finished_key,
           Transcript-Hash(Handshake Context,
                           Certificate*,
                           KEMEncapsulation*,
                           Finished**)

*  Only included if present.
** The party who last sends the finished message in terms of flights
   includes the other party's Finished message.
</pre><a href="#section-6.4.4-7" class="pilcrow">Â¶</a>
</div>
<p id="section-6.4.4-8">See the <span><a href="#sec-authkem-pdk-negotiation" class="xref">abbreviated AuthKEM handshake negotiation section</a> (<a href="#sec-authkem-pdk-negotiation" class="xref">Section 5.1</a>)</span> for special considerations for the abbreviated AuthKEM handshake.<a href="#section-6.4.4-8" class="pilcrow">Â¶</a></p>
<p id="section-6.4.4-9">Any records following a Finished message MUST be encrypted under the appropriate application traffic key as described in TLS 1.3.
In particular, this includes any alerts sent by the server in response to client <code>Certificate</code> and <code>KEMEncapsulation</code> messages.<a href="#section-6.4.4-9" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-7-1.1">The academic works proposing KEM-Auth contain a in-depth technical discussion
of and a proof of the security of the handshake protocol without client
authentication <span>[<a href="#KEMTLS" class="xref">KEMTLS</a>]</span>. The work proposing the variant protocol <span>[<a href="#KEMTLSPDK" class="xref">KEMTLSPDK</a>]</span>
with pre-distributed public keys has a proof for both unilaterally and
mutually authenticated handshakes.<a href="#section-7-1.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-7-1.2">Application Data sent prior to receiving the server's last explicit
authentication message (the Finished message) can be subject to a client
downgrade attack, and has weaker forward secrecy compared to TLS 1.3.
Full downgrade resilience and forward secrecy is achieved once the handshake
completes.<a href="#section-7-1.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-7-1.3">The client's certificate is kept secret from active observers by the
derivation of the <code>client_authenticated_handshake_secret</code>, which ensures that
only the intended server can read the client's identity.<a href="#section-7-1.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-7-1.4">When the client opportunistically sends its certificate, it is not encrypted
under a forward-secure key.  This has similar considerations and trade-offs as
0-RTT data.  If it is a replayed message, there are no expected consequences
for security as the malicious replayer will not be able to decapsulate the
shared secret.<a href="#section-7-1.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-7-1.5">A client that opportunistically sends its certificate, SHOULD send it
encrypted with a ciphertext that it knows the server will accept. Otherwise,
it will fail.<a href="#section-7-1.5" class="pilcrow">Â¶</a>
</li>
      </ul>
<div id="implicit-authentication">
<section id="section-7.1">
        <h3 id="name-implicit-authentication">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-implicit-authentication" class="section-name selfRef">Implicit authentication</a>
        </h3>
<p id="section-7.1-1">Because preserving a 1/1.5RTT handshake in KEM-Auth requires the client to
send its request in the same flight when the <code>ServerHello</code> message is received,
it can not yet have explicitly authenticated the server. However,
through the inclusion of the key encapsulated to the server's long-term
secret, only an authentic server should be able to decrypt these messages.<a href="#section-7.1-1" class="pilcrow">Â¶</a></p>
<p id="section-7.1-2">However, the client can not have received confirmation that the server's
choices for symmetric encryption, as specified in the <code>ServerHello</code> message,
were authentic. These are not authenticated until the <code>Finished</code> message from
the server arrived. This may allow an adversary to downgrade the symmetric
algorithms, but only to what the client is willing to accept. If such an attack
occurs, the handshake will also never successfully complete and no data can be
sent back.<a href="#section-7.1-2" class="pilcrow">Â¶</a></p>
<p id="section-7.1-3">If the client trusts the symmetric algorithms advertised in its <code>ClientHello</code>
message, this should not be a concern. A client MUST NOT accept any
cryptographic parameters it does not include in its own <code>ClientHello</code> message.<a href="#section-7.1-3" class="pilcrow">Â¶</a></p>
<p id="section-7.1-4">If client authentication is used, explicit authentication is reached before
any application data, on either client or server side, is transmitted.<a href="#section-7.1-4" class="pilcrow">Â¶</a></p>
<p id="section-7.1-5">Application Data MUST NOT be sent prior to sending the Finished
message, except as specified in Section 2.3 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.  Note that
while the client MAY send Application Data prior to receiving the server's
last explicit Authentication message, any data sent at that point is,
being sent to an implicitly authenticated peer.<a href="#section-7.1-5" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="old-text-below">
<section id="section-8">
      <h2 id="name-old-text-below">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-old-text-below" class="section-name selfRef">OLD TEXT BELOW</a>
    </h2>
</section>
</div>
<div id="protocol-overview">
<section id="section-9">
      <h2 id="name-protocol-overview">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-9-1">Figure 1 below shows the basic full KEM-authentication (KEM-Auth) handshake:<a href="#section-9-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-9-2">
<pre>
       Client                                     Server

Key  ^ ClientHello
Exch | + key_share
     v + signature_algorithms
                          --------&gt;
                                             ServerHello  ^ Key
                                       +       key_share  v Exch
                                   &lt;EncryptedExtensions&gt;  ^ Server
                                    &lt;CertificateRequest&gt;  v Params
     ^                                     &lt;Certificate&gt;  ^
Auth | &lt;KEMEncapsulation&gt;                                 | Auth
     | {Certificate}       --------&gt;                      |
     |                     &lt;--------  {KEMEncapsulation}  |
     | {Finished}          --------&gt;                      |
     | [Application Data*] --------&gt;                      |
     v                     &lt;-------           {Finished}  |
                                                          v
       [Application Data]  &lt;-------&gt;  [Application Data]

        +  Indicates noteworthy extensions sent in the
           previously noted message.
        *  Indicates optional or situation-dependent
           messages/extensions that are not always sent.
        &lt;&gt; Indicates messages protected using keys
           derived from a [sender]_handshake_traffic_secret.
        {} Indicates messages protected using keys
           derived from a
           [sender]_authenticated_handshake_traffic_secret.
        [] Indicates messages protected using keys
           derived from [sender]_application_traffic_secret_N.

       Figure 1: Message Flow for KEM-Authentication (KEM-Auth) Handshake
</pre><a href="#section-9-2" class="pilcrow">Â¶</a>
</div>
<p id="section-9-3">When using KEMs for authentication, the handshake can be thought of in four
phases compared to the three ones from TLS 1.3. It achieves both confidentiality
and authentication (certificate-based).<a href="#section-9-3" class="pilcrow">Â¶</a></p>
<p id="section-9-4">After the Key Exchange and Server Parameters phase of TLS 1.3 handshake, the
client and server exchange implicitly authenticated messages.
KEM-based authentication uses the same set of messages every time that
certificate-based authentication is needed.  Specifically:<a href="#section-9-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-5.1">Certificate:  The certificate of the endpoint and any per-certificate
extensions.  This message is omitted by the client if the server
did not send CertificateRequest (thus indicating that the client
should not authenticate with a certificate). The Certificate
MUST include the long-term KEM public key.<a href="#section-9-5.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-9-5.2">KEMEncapsulation: A key encapsulation against the certificate's long-term
public key, which yields an implicitly authenticated shared secret.<a href="#section-9-5.2" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-9-6">Upon receiving the server's messages, the client responds with its
Authentication messages, namely Certificate and KEMEncapsulation (if
requested). If client authentication was not requested, the Client
sends its Finished message.<a href="#section-9-6" class="pilcrow">Â¶</a></p>
<p id="section-9-7">Upon receiving the client's messages, the server responds with its
Finished message, which achieves explicit authentication.
Upon receiving the server's Finished message, the client achieves explicit
authentication.<a href="#section-9-7" class="pilcrow">Â¶</a></p>
<p id="section-9-8">Application Data MUST NOT be sent prior to sending the Finished
message, except as specified in Section 2.3 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.  Note that
while the client may send Application Data prior to receiving the server's
last explicit Authentication message, any data sent at that point is, of course,
being sent to an implicitly authenticated peer. It is worth noting
that Application Data sent prior to receiving the server's last
Authentication message can be subject to a client downgrade
attack. Full downgrade resilience is only achieved when explicit
authentication is achieved: when the Client receives the Finished
message from the Server.<a href="#section-9-8" class="pilcrow">Â¶</a></p>
<div id="prior-knowledge-kem-auth">
<section id="section-9.1">
        <h3 id="name-prior-knowledge-kem-auth">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-prior-knowledge-kem-auth" class="section-name selfRef">Prior-knowledge KEM-Auth</a>
        </h3>
<p id="section-9.1-1">Given the added number of round-trips of KEM-auth compared to the TLS 1.3,
the handshake can be improved by the usage of pre-distributed
KEM authentication keys to achieve explicit authentication and full downgrade
resilience as early as possible. A peer's long-term KEM authentication key can
be cached in advance, as well.<a href="#section-9.1-1" class="pilcrow">Â¶</a></p>
<p id="section-9.1-2">Figure 2 below shows a pair of handshakes in which the first handshake
establishes cached information and the second handshake uses it:<a href="#section-9.1-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-3">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + key_share
     v + signature_algorithms
                              --------&gt;
                                                ServerHello  ^ Key
                                               +  key_share  v Exch
                                      &lt;EncryptedExtensions&gt;  ^ Server
                                       &lt;CertificateRequest&gt;  v Params
     ^                                        &lt;Certificate&gt;  ^
Auth | &lt;KEMEncapsulation&gt;                                    | Auth
     | {Certificate}          --------&gt;                      |
     |                        &lt;--------  {KEMEncapsulation}  |
     | {Finished}             --------&gt;                      |
     | [Cached Server Certificate]                           |
     | [Application Data*]    --------&gt;                      |
     v                        &lt;-------           {Finished}  |
                                                             v
       [Application Data]     &lt;-------&gt;  [Application Data]

       Client                                        Server

Key  ^ ClientHello
Exch | + key_share
&amp;    | + stored_auth_key_extension
Auth | + kem_encapsulation_extension
     | + signature_algorithms
     | &lt;Certificate&gt;         --------&gt;         ServerHello  ^ Key
     |                                   +       key_share  | Exch,
     |                      +  {stored_auth_key_extension}  | Auth &amp;
     |                               {EncryptedExtensions}  | Server
     |                                  {KEMEncapsulation}  | Params
     |                       &lt;--------          {Finished}  v
     |                       &lt;-------- [Application Data*]
     v {Finished}            --------&gt;

       [Application Data]    &lt;-------&gt;  [Application Data]
</pre><a href="#section-9.1-3" class="pilcrow">Â¶</a>
</div>
<p id="section-9.1-4">In some applications, such as in a VPN, the client already knows that the
server will require mutual authentication. This means that a client can proactively
authenticate by sending its certificate as early in the handshake as possible.
The client's certificate has to be sent encrypted by using the shared secret
derived from the kem_encapsulation message.<a href="#section-9.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="key-exchange-messages">
<section id="section-9.2">
        <h3 id="name-key-exchange-messages">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-key-exchange-messages" class="section-name selfRef">Key Exchange Messages</a>
        </h3>
<p id="section-9.2-1">KEM-Auth uses the same key exchange messages as TLS 1.3 with this
exceptions:<a href="#section-9.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-2.1">Two extensions can be added to the <code>ClientHello</code> message: "stored_auth_key"
and "kem_encapsulation".<a href="#section-9.2-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-9.2-2.2">One extensions can be added to the <code>ServerHello</code> message: "stored_auth_key".<a href="#section-9.2-2.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-9.2-3">KEM-Auth preserves the same cryptographic negotiation with the addition
of the KEM algorithms to the <code>signature_algorithms</code>.<a href="#section-9.2-3" class="pilcrow">Â¶</a></p>
<div id="client-hello">
<section id="section-9.2.1">
          <h4 id="name-client-hello">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-client-hello" class="section-name selfRef">Client Hello</a>
          </h4>
<p id="section-9.2.1-1">KEM-Auth uses the <code>ClientHello</code> message as described for TLS 1.3. When used
in a pre-distributed mode, however, two extensions are mandatory: "stored_auth_key"
and "kem_encapsulation" for server authentication. This extensions are
described later in the document.<a href="#section-9.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.1-2">Note that in KEM-Auth with pre-distributed information, the client's <code>Certificate</code>
message gets send alongside the <code>ClientHello</code> one for mutual authentication.<a href="#section-9.2.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="server-hello">
<section id="section-9.2.2">
          <h4 id="name-server-hello">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-server-hello" class="section-name selfRef">Server Hello</a>
          </h4>
<p id="section-9.2.2-1">KEM-Auth uses the <code>ServerHello</code> message as described for TLS 1.3. When used
in a pre-distributed mode, however, one extension is mandatory: "stored_auth_key"
for server authentication. This extension is described later in the document.<a href="#section-9.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.2-2">When the ServerHello message is received:<a href="#section-9.2.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.2-3.1">the client and server derive handshake traffic secrets <code>client_handshake_traffic_secret</code>
and <code>server_handshake_traffic_secret</code> which are used to encrypt subsequent
flows in the handshake<a href="#section-9.2.2-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-9.2.2-3.2">the "handshake secret" is derived: <code>dHS</code> which is kept as the
current secret state of the key schedule.<a href="#section-9.2.2-3.2" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-9.2.2-4">Refer to Section 8.1 for information on how to derive this secrets.<a href="#section-9.2.2-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="hello-retry-request">
<section id="section-9.2.3">
          <h4 id="name-hello-retry-request">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-hello-retry-request" class="section-name selfRef">Hello Retry Request</a>
          </h4>
<p id="section-9.2.3-1">KEM-Auth uses the <code>ServerHello</code> message as described for TLS 1.3. When used
in a pre-distributed mode for mutual authentication, a <code>HelloRetryRequest</code>
message can be sent, but the client's <code>Certificate</code> message is ignored.<a href="#section-9.2.3-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="extensions">
<section id="section-9.2.4">
          <h4 id="name-extensions">
<a href="#section-9.2.4" class="section-number selfRef">9.2.4. </a><a href="#name-extensions" class="section-name selfRef">Extensions</a>
        </h4>
</section>
</div>
<div id="implicit-authentication-messages">
<section id="section-9.2.5">
          <h4 id="name-implicit-authentication-mes">
<a href="#section-9.2.5" class="section-number selfRef">9.2.5. </a><a href="#name-implicit-authentication-mes" class="section-name selfRef">Implicit Authentication Messages</a>
          </h4>
<p id="section-9.2.5-1">As discussed, KEM-Auth generally uses a common set of messages for implicit
authentication and key confirmation: Certificate and KEMEncapsulation.
The CertificateVerify message MUST NOT be sent.<a href="#section-9.2.5-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.5-2">The computations for the Authentication messages take the following inputs:<a href="#section-9.2.5-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.5-3.1">The certificate and authentication key to be used.<a href="#section-9.2.5-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-9.2.5-3.2">A Handshake Context consisting of the set of messages to be included in the
transcript hash.<a href="#section-9.2.5-3.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-9.2.5-3.3">A Shared Secret Key (from the key exchange operations) to be used to compute an
authenticated handshake shared key.<a href="#section-9.2.5-3.3" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-9.2.5-3.4">A Handshake Context consisting of the set of messages to be
included in the transcript hash.<a href="#section-9.2.5-3.4" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-9.2.5-4">Based on these inputs, the messages then contain:<a href="#section-9.2.5-4" class="pilcrow">Â¶</a></p>
<p id="section-9.2.5-5">Certificate:  The certificate to be used for authentication, and any supporting
  certificates in the chain.<a href="#section-9.2.5-5" class="pilcrow">Â¶</a></p>
<p id="section-9.2.5-6">KEMEncapsulation: The KEM encapsulation against the end-entity
  certificate's public key(s).<a href="#section-9.2.5-6" class="pilcrow">Â¶</a></p>
<p id="section-9.2.5-7">KEM-Auth follows the TLS 1.3 key schedule, which applies a sequence of HKDF
operations to the Handshake Secret Keys and the handshake context to derive:<a href="#section-9.2.5-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.5-8.1">the client and server authenticated handshake traffic secrets
<code>client_handshake_authenticated_traffic_secret</code>
and <code>server_handshake_authenticated_traffic_secret</code> which are used to
encrypt subsequent flows in the handshake<a href="#section-9.2.5-8.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-9.2.5-8.2">updated secret state <code>dAHS</code> of the key schedule.<a href="#section-9.2.5-8.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-9.2.5-8.3">a Master Key.<a href="#section-9.2.5-8.3" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<div id="certificate">
<section id="section-9.2.6">
          <h4 id="name-certificate">
<a href="#section-9.2.6" class="section-number selfRef">9.2.6. </a><a href="#name-certificate" class="section-name selfRef">Certificate</a>
          </h4>
<p id="section-9.2.6-1">KEM-Auth uses the same <code>Certificate</code> message as TLS 1.3.<a href="#section-9.2.6-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.6-2">The end-entity <code>Certificate</code> or the <code>RawPublicKey</code> MUST contain or be a
KEM public key.<a href="#section-9.2.6-2" class="pilcrow">Â¶</a></p>
<p id="section-9.2.6-3">Note that we are only specifying here the algorithms in the end-entity
<code>Certificate</code>. All certificates provided by the server or client MUST be
signed by an authentication algorithm advertised by the server or client.<a href="#section-9.2.6-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="kem-encapsulation">
<section id="section-9.2.7">
          <h4 id="name-kem-encapsulation">
<a href="#section-9.2.7" class="section-number selfRef">9.2.7. </a><a href="#name-kem-encapsulation" class="section-name selfRef">KEM Encapsulation</a>
          </h4>
<p id="section-9.2.7-1">This message is used to provide implicit proof that an endpoint
possesses the private key(s) corresponding to its certificate by sending
the appropriate parameters that will be used to calculate the implicitly
authenticated shared secret.<a href="#section-9.2.7-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-2">The calculation of the shared secret also provides integrity for the handshake
up to this point. Servers MUST send this message when authenticating via a
certificate. Clients MUST send this message whenever authenticating via a
certificate (i.e., when the <code>Certificate</code> message is non-empty). When sent, this
message MUST appear immediately after the <code>Certificate</code> message has been
received and prior to the <code>Finished</code> message.<a href="#section-9.2.7-2" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-3">Structure of this message:<a href="#section-9.2.7-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2.7-4">
<pre>
  struct {
      opaque certificate_request_context&lt;0..2^8-1&gt;
      opaque encapsulation&lt;0..2^16-1&gt;;
  } KEMEncapsulation;
</pre><a href="#section-9.2.7-4" class="pilcrow">Â¶</a>
</div>
<p id="section-9.2.7-5">The encapsulation field is the result of a <code>Encapsulate</code> function. The
Encapsulation() function will also result in a shared secret (<code>ssS</code> or <code>ssC</code>,
depending on the peer) which is used to derive the <code>AHS</code> or <code>MS</code> secrets.<a href="#section-9.2.7-5" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-6">If the <code>KEMEncapsulation</code> message is sent by a server, the authentication
algorithm MUST be one offered in the client's <code>signature_algorithms</code>
extension unless no valid certificate chain can be produced without
unsupported algorithms.<a href="#section-9.2.7-6" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-7">If sent by a client, the authentication algorithm used in the signature
MUST be one of those present in the <code>supported_signature_algorithms</code>
field of the <code>signature_algorithms</code> extension in the
<code>CertificateRequest</code> message.<a href="#section-9.2.7-7" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-8">In addition, the authentication algorithm MUST be compatible with the key(s)
in the sender's end-entity certificate.<a href="#section-9.2.7-8" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-9">The receiver of a <code>KEMEncapsulation</code> message MUST perform the <code>Decapsulate(enc, skR)</code>
operation by using the sent encapsulation and the private key of the public key
advertised in the end-entity certificate sent. The <code>Decapsulate(enc, skR)</code> function
will also result on a shared secret (<code>ssS</code> or <code>ssC</code>, depending on the Server or
Client executing it respectively) which is used to derive the <code>AHS</code> or <code>MS</code> secrets.<a href="#section-9.2.7-9" class="pilcrow">Â¶</a></p>
<p id="section-9.2.7-10"><code>certificate_request_context</code> is included to allow the recipient to identify the
certificate against which the encapsulation was generated. It MUST be set to the 
value in the <code>Certificate</code> message to which the encapsulation was computed.<a href="#section-9.2.7-10" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="explicit-authentication-messages-1">
<section id="section-9.2.8">
          <h4 id="name-explicit-authentication-mess">
<a href="#section-9.2.8" class="section-number selfRef">9.2.8. </a><a href="#name-explicit-authentication-mess" class="section-name selfRef">Explicit Authentication Messages</a>
          </h4>
<p id="section-9.2.8-1">As discussed, KEM-Auth generally uses a message for explicit
authentication: Finished message. Note that in the non pre-distributed mode,
KEM-Auth achieves explicit authentication only when the server sends the final
<code>Finished</code> message (the client is only implicitly authenticated when they
send their <code>Finished</code> message). In a pre-distributed mode, the server achieves
explicit authentication when sending their <code>Finished</code> message (one round-trip
earlier) and the client, in turn, when they send their <code>Finished</code> message
(one round-trip earlier). Full downgrade resilience and forward secrecy
is achieved once the KEM-Auth handshake completes.<a href="#section-9.2.8-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.8-2">The key used to compute the <code>Finished</code> message is computed from the
<code>MainSecret</code> using HKDF. Specifically:<a href="#section-9.2.8-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2.8-3">
<pre>
server/client_finished_key =
  HKDF-Expand-Label(MainSecret,
                    server/client_label,
                    "", Hash.length)
server_label = "tls13 server finished"
client_label = "tls13 client finished"
</pre><a href="#section-9.2.8-3" class="pilcrow">Â¶</a>
</div>
<p id="section-9.2.8-4">Structure of this message:<a href="#section-9.2.8-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2.8-5">
<pre>
  struct {
      opaque verify_data[Hash.length];
  } Finished;
</pre><a href="#section-9.2.8-5" class="pilcrow">Â¶</a>
</div>
<p id="section-9.2.8-6">The verify_data value is computed as follows:<a href="#section-9.2.8-6" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2.8-7">
<pre>
server/client_verify_data =
      HMAC(server/client_finished_key,
           Transcript-Hash(Handshake Context,
                           Certificate*,
                           KEMEncapsulation*,
                           Finished**)
</pre><a href="#section-9.2.8-7" class="pilcrow">Â¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-9.2.8-8.1">Only included if present.
** The party who last sends the finished message in terms of flights
includes the other party's Finished message.<a href="#section-9.2.8-8.1" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-9.2.8-9">Any records following a Finished message MUST be encrypted under the
appropriate application traffic key as described in TLS 1.3.  In
particular, this includes any alerts sent by the server in response
to client Certificate and KEMEncapsulation messages.<a href="#section-9.2.8-9" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-tls-semistatic-dh">[I-D.ietf-tls-semistatic-dh]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Semi-Static Diffie-Hellman Key Establishment for TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-semistatic-dh-01</span>, <time datetime="2020-03-07" class="refDate">7 March 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-semistatic-dh-01">https://datatracker.ietf.org/doc/html/draft-ietf-tls-semistatic-dh-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-subcerts">[I-D.ietf-tls-subcerts]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Iyengar, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Delegated Credentials for TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-subcerts-11</span>, <time datetime="2021-09-23" class="refDate">23 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-subcerts-11">https://datatracker.ietf.org/doc/html/draft-ietf-tls-subcerts-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hpke">[I-D.irtf-cfrg-hpke]</dt>
        <dd>
<span class="refAuthor">Barnes, R. L.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hpke-12</span>, <time datetime="2021-09-02" class="refDate">2 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hpke-12">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hpke-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8410">[RFC8410]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure"</span>, <span class="seriesInfo">RFC 8410</span>, <span class="seriesInfo">DOI 10.17487/RFC8410</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8410">https://www.rfc-editor.org/rfc/rfc8410</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="KEMTLS">[KEMTLS]</dt>
        <dd>
<span class="refAuthor">Stebila, D.</span>, <span class="refAuthor">Schwabe, P.</span>, and <span class="refAuthor">T. Wiggers</span>, <span class="refTitle">"Post-Quantum TLS without Handshake Signatures"</span>, <span class="seriesInfo">DOI 10.1145/3372297.3423350</span>, <span class="seriesInfo">IACR ePrint https://ia.cr/2020/534</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://doi.org/10.1145/3372297.3423350">https://doi.org/10.1145/3372297.3423350</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KEMTLSPDK">[KEMTLSPDK]</dt>
        <dd>
<span class="refAuthor">Stebila, D.</span>, <span class="refAuthor">Schwabe, P.</span>, and <span class="refAuthor">T. Wiggers</span>, <span class="refTitle">"More Efficient KEMTLS with Pre-Shared Keys"</span>, <span class="seriesInfo">DOI 10.1007/978-3-030-88418-5_1</span>, <span class="seriesInfo">IACR ePrint https://ia.cr/2021/779</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-030-88418-5_1">https://doi.org/10.1007/978-3-030-88418-5_1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KW16">[KW16]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">H. Wee</span>, <span class="refTitle">"The OPTLS Protocol and TLS 1.3"</span>, <span class="seriesInfo">Proceedings of Euro S"P 2016 </span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://eprint.iacr.org/2015/978">https://eprint.iacr.org/2015/978</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NISTPQC">[NISTPQC]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Post-Quantum Cryptography Standardization"</span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5869">https://www.rfc-editor.org/rfc/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">This work has been supported by the European Research Council through
Starting Grant No. 805031 (EPOQUE).<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">SofÃ­a Celi</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cherenkov@riseup.net" class="email">cherenkov@riseup.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter Schwabe</span></div>
<div dir="auto" class="left"><span class="org">Radboud University &amp; MPI S&amp;P</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:peter@cryptojedi.org" class="email">peter@cryptojedi.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Douglas Stebila</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dstebila@uwaterloo.ca" class="email">dstebila@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nick Sullivan</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nick@cloudflare.com" class="email">nick@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thom Wiggers</span></div>
<div dir="auto" class="left"><span class="org">Radboud University</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thom@thomwiggers.nl" class="email">thom@thomwiggers.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
